Lab: Username enumeration via response timing

1. ค้นหา Username ด้วยเวลาตอบสนอง
หลักการ: เมื่อส่งคำขอ (request) ที่มี username และ password ไปยังเซิร์ฟเวอร์ ระบบจะตรวจสอบความถูกต้องของ username ก่อน จากนั้นจึงตรวจสอบ password หาก username ไม่ถูกต้อง ระบบมักจะตอบสนองทันที แต่ถ้า username ถูกต้อง ระบบจะใช้เวลาตรวจสอบ password เพิ่มเติม ซึ่งส่งผลให้เวลาตอบสนองนานขึ้น
วิธีการ:
- สร้างคำขอ HTTP ที่ส่ง username และ password ไปยังเซิร์ฟเวอร์ (เช่น ผ่าน Burp Suite)
- ทดสอบชื่อผู้ใช้ที่เป็นไปได้หลายๆรายการ โดยเก็บข้อมูลเวลาตอบสนอง (response time) ของแต่ละคำขอ
- สังเกตเวลาตอบสนองที่นานกว่าปกติ ซึ่งมักบ่งชี้ว่า username นั้นถูกต้อง
2. ค้นหา Password ด้วย HTTP 302
หลักการ: หลังจากระบุ username ที่ถูกต้องแล้ว การค้นหารหัสผ่านที่ถูกต้องจะขึ้นอยู่กับสถานะการตอบสนอง (response status code) ของเซิร์ฟเวอร์
เมื่อ username และ password ถูกต้อง ระบบมักจะตอบสนองด้วย HTTP 302 (Redirect) ซึ่งบ่งชี้ว่าสามารถเข้าสู่ระบบได้
หาก password ไม่ถูกต้อง ระบบจะตอบสนองด้วยรหัสสถานะอื่น เช่น 401 (Unauthorized) หรือ 200 (แต่แสดงข้อผิดพลาด)
วิธีการ:
- ใช้ username ที่ถูกต้องที่ได้จากขั้นตอนก่อนหน้า
- ทดสอบรหัสผ่านที่เป็นไปได้ทีละรายการ
สังเกตคำตอบของเซิร์ฟเวอร์:
หากเซิร์ฟเวอร์ตอบกลับด้วย HTTP 302 แสดงว่ารหัสผ่านนั้นถูกต้อง
หากไม่ใช่ HTTP 302 ให้ลองรหัสผ่านถัดไป

สรุปการทำงาน
ค้นหา Username: ตรวจสอบเวลาตอบสนองของเซิร์ฟเวอร์เพื่อหา username ที่ใช้เวลาตอบสนองนานที่สุด
ค้นหา Password: ใช้ username ที่ได้แล้วทดลองรหัสผ่าน โดยดูที่สถานะการตอบกลับ HTTP 302 เพื่อยืนยันรหัสผ่านที่ถูกต้อง
